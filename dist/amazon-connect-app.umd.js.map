{"version":3,"file":"amazon-connect-app.umd.js","sources":["../node_modules/@amazon-connect/core/lib-esm/provider/global-provider.js","../node_modules/@amazon-connect/core/lib-esm/error/connect-error.js","../node_modules/@amazon-connect/core/lib-esm/utility/deep-clone.js","../node_modules/@amazon-connect/core/lib-esm/utility/emitter/emitter-base.js","../node_modules/@amazon-connect/core/lib-esm/utility/emitter/async-event-emitter.js","../node_modules/@amazon-connect/core/lib-esm/utility/id-generator.js","../node_modules/@amazon-connect/core/lib-esm/proxy/module-proxy-factory.js","../node_modules/@amazon-connect/core/lib-esm/messaging/subscription/subscription-handler-id-map.js","../node_modules/@amazon-connect/core/lib-esm/messaging/subscription/subscription-map.js","../node_modules/@amazon-connect/core/lib-esm/messaging/subscription/subscription-manager.js","../node_modules/@amazon-connect/core/lib-esm/metric/duration-metric-recorder.js","../node_modules/@amazon-connect/core/lib-esm/metric/metric-helpers.js","../node_modules/@amazon-connect/core/lib-esm/metric/connect-metric-recorder.js","../node_modules/@amazon-connect/core/lib-esm/request/client-timeout-error.js","../node_modules/@amazon-connect/core/lib-esm/request/request-handler-factory.js","../node_modules/@amazon-connect/core/lib-esm/request/request-manager.js","../node_modules/@amazon-connect/core/lib-esm/request/request-message-factory.js","../node_modules/@amazon-connect/core/lib-esm/messaging/downstream-message-sanitizer.js","../node_modules/@amazon-connect/core/lib-esm/proxy/channel-manager.js","../node_modules/@amazon-connect/core/lib-esm/proxy/error/error-service.js","../node_modules/@amazon-connect/core/lib-esm/proxy/health-check/health-check-manager.js","../node_modules/@amazon-connect/core/lib-esm/proxy/proxy-connection/proxy-connection-status-manager.js","../node_modules/@amazon-connect/core/lib-esm/proxy/proxy.js","../node_modules/@amazon-connect/core/lib-esm/utility/timeout-tracker.js","../node_modules/@amazon-connect/core/lib-esm/logging/log-level.js","../node_modules/@amazon-connect/core/lib-esm/logging/log-data-console-writer.js","../node_modules/@amazon-connect/core/lib-esm/logging/log-data-transformer.js","../node_modules/@amazon-connect/core/lib-esm/logging/connect-logger.js","../node_modules/@amazon-connect/core/lib-esm/logging/sanitize-data.js","../node_modules/@amazon-connect/core/lib-esm/logging/log-message-factory.js","../node_modules/@amazon-connect/core/lib-esm/provider/provider-base.js","../node_modules/@amazon-connect/core/lib-esm/context/module-context.js","../node_modules/@amazon-connect/core/lib-esm/context/context.js","../node_modules/@amazon-connect/core/lib-esm/sdk-version.js","../node_modules/@amazon-connect/app/lib-esm/app-context.js","../node_modules/@amazon-connect/app/lib-esm/lifecycle/lifecycle-manager.js","../node_modules/@amazon-connect/app/lib-esm/lifecycle/app-lifecycle-manager.js","../node_modules/@amazon-connect/app/lib-esm/proxy/connection-timeout.js","../node_modules/@amazon-connect/app/lib-esm/proxy/app-proxy.js","../node_modules/@amazon-connect/app/lib-esm/amazon-connect-app.js","../node_modules/@amazon-connect/app/lib-esm/contact-scope.js","../node_modules/@amazon-connect/app/lib-esm/lifecycle/service-lifecycle-manager.js","../node_modules/@amazon-connect/app/lib-esm/service/amazon-connect-service.js","../node_modules/@amazon-connect/app/lib-esm/service/service-context.js"],"sourcesContent":["let _provider;\nexport function setGlobalProvider(provider) {\n    if (_provider)\n        throw new Error(\"Global Provider is already set\");\n    _provider = provider;\n}\nexport function resetGlobalProvider(provider) {\n    _provider = provider;\n}\nexport function getGlobalProvider(notSetMessage) {\n    if (!_provider) {\n        throw new Error(notSetMessage !== null && notSetMessage !== void 0 ? notSetMessage : \"Attempted to get Global AmazonConnectProvider that has not been set.\");\n    }\n    return _provider;\n}\n//# sourceMappingURL=global-provider.js.map","export class ConnectError extends Error {\n    constructor({ reason, namespace, errorKey, details, }) {\n        super(`ConnectError with error key \"${errorKey}\"`);\n        this.errorType = ConnectError.ErrorType;\n        this.namespace = namespace;\n        this.errorKey = errorKey;\n        this.reason = reason;\n        this.details = details !== null && details !== void 0 ? details : {};\n    }\n}\nConnectError.ErrorType = \"ConnectError\";\nexport function isConnectError(error) {\n    return Boolean(error instanceof ConnectError ||\n        (error &&\n            typeof error === \"object\" &&\n            \"errorType\" in error &&\n            error.errorType === ConnectError.ErrorType));\n}\n//# sourceMappingURL=connect-error.js.map","import { ConnectError } from \"../error\";\nexport function deepClone(object) {\n    try {\n        return structuredClone(object);\n    }\n    catch (_a) {\n        try {\n            // Falls back to JSON parse/stringify if structureClone does not exist\n            return JSON.parse(JSON.stringify(object));\n        }\n        catch (cloneError) {\n            throw new ConnectError({\n                errorKey: \"deepCloneFailed\",\n                details: {\n                    actualError: cloneError,\n                },\n            });\n        }\n    }\n}\n//# sourceMappingURL=deep-clone.js.map","import { ConnectLogger } from \"../../logging\";\nexport class EmitterBase {\n    constructor({ provider, loggerKey }) {\n        this.events = new Map();\n        this.logger = new ConnectLogger({\n            provider,\n            source: \"emitter\",\n            mixin: () => ({\n                emitterLoggerKey: loggerKey,\n            }),\n        });\n    }\n    on(parameter, handler) {\n        const set = this.events.get(parameter);\n        if (set)\n            set.add(handler);\n        else\n            this.events.set(parameter, new Set([handler]));\n    }\n    off(parameter, handler) {\n        const set = this.events.get(parameter);\n        if (set) {\n            set.delete(handler);\n            if (set.size < 1)\n                this.events.delete(parameter);\n        }\n    }\n    getHandlers(parameter) {\n        var _a;\n        return Array.from((_a = this.events.get(parameter)) !== null && _a !== void 0 ? _a : []);\n    }\n}\n//# sourceMappingURL=emitter-base.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { EmitterBase } from \"./emitter-base\";\nexport class AsyncEventEmitter extends EmitterBase {\n    emit(parameter, event) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const handlers = this.getHandlers(parameter);\n            yield Promise.allSettled(handlers.map((handler) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    yield handler(event);\n                }\n                catch (error) {\n                    this.logger.error(\"An error occurred when invoking event handler\", {\n                        error,\n                        parameter,\n                    });\n                }\n            })));\n        });\n    }\n}\n//# sourceMappingURL=async-event-emitter.js.map","export function generateStringId(length) {\n    const a = new Uint8Array(Math.ceil(length / 2));\n    crypto.getRandomValues(a);\n    return Array.from(a, (d) => d.toString(16).padStart(2, \"0\"))\n        .join(\"\")\n        .substring(0, length);\n}\nexport function generateUUID() {\n    if (\"randomUUID\" in crypto) {\n        return crypto.randomUUID();\n    }\n    else {\n        return \"10000000-1000-4000-8000-100000000000\".replace(/[018]/g, (c) => {\n            const d = parseInt(c);\n            return (d ^\n                (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (d / 4)))).toString(16);\n        });\n    }\n}\n//# sourceMappingURL=id-generator.js.map","export function createModuleProxy(proxy, namespace) {\n    return {\n        request: (command, data) => proxy.request(namespace, command, data),\n        subscribe: (topic, handler) => proxy.subscribe(Object.assign(Object.assign({}, topic), { namespace }), handler),\n        unsubscribe: (topic, handler) => proxy.unsubscribe(Object.assign(Object.assign({}, topic), { namespace }), handler),\n        getProxyInfo: () => ({\n            connectionStatus: proxy.connectionStatus,\n            proxyType: proxy.proxyType,\n        }),\n        onConnectionStatusChange: (h) => proxy.onConnectionStatusChange(h),\n        offConnectionStatusChange: (h) => proxy.offConnectionStatusChange(h),\n    };\n}\n//# sourceMappingURL=module-proxy-factory.js.map","import { generateUUID } from \"../../utility\";\nexport class SubscriptionHandlerIdMap {\n    constructor() {\n        this.idsByHandler = new Map();\n        this.handlersById = new Map();\n    }\n    add(handler) {\n        const existingId = this.idsByHandler.get(handler);\n        if (existingId) {\n            return { handlerId: existingId };\n        }\n        const handlerId = generateUUID();\n        this.idsByHandler.set(handler, handlerId);\n        this.handlersById.set(handlerId, handler);\n        return { handlerId };\n    }\n    getIdByHandler(handler) {\n        var _a;\n        return (_a = this.idsByHandler.get(handler)) !== null && _a !== void 0 ? _a : null;\n    }\n    getHandlerById(id) {\n        var _a;\n        return (_a = this.handlersById.get(id)) !== null && _a !== void 0 ? _a : null;\n    }\n    get() {\n        return [...this.idsByHandler.entries()].map(([handler, handlerId]) => ({\n            handler,\n            handlerId,\n        }));\n    }\n    delete(handler) {\n        const handlerId = this.idsByHandler.get(handler);\n        if (handlerId)\n            this.handlersById.delete(handlerId);\n        this.idsByHandler.delete(handler);\n        return { isEmpty: this.idsByHandler.size < 1 };\n    }\n    size() {\n        return this.idsByHandler.size;\n    }\n}\n//# sourceMappingURL=subscription-handler-id-map.js.map","export class SubscriptionMap {\n    constructor() {\n        this.simpleSubscriptions = new Map();\n        this.paramSubscriptions = new Map();\n    }\n    add({ namespace, key, parameter: param }, value) {\n        var _a, _b, _c, _d, _e;\n        if (param) {\n            if (!this.paramSubscriptions.has(namespace)) {\n                this.paramSubscriptions.set(namespace, new Map([[key, new Map([[param, value]])]]));\n                return;\n            }\n            if (!((_a = this.paramSubscriptions.get(namespace)) === null || _a === void 0 ? void 0 : _a.has(key))) {\n                (_b = this.paramSubscriptions\n                    .get(namespace)) === null || _b === void 0 ? void 0 : _b.set(key, new Map([[param, value]]));\n                return;\n            }\n            (_d = (_c = this.paramSubscriptions.get(namespace)) === null || _c === void 0 ? void 0 : _c.get(key)) === null || _d === void 0 ? void 0 : _d.set(param, value);\n        }\n        else {\n            if (!this.simpleSubscriptions.has(namespace)) {\n                this.simpleSubscriptions.set(namespace, new Map([[key, value]]));\n                return;\n            }\n            else\n                (_e = this.simpleSubscriptions.get(namespace)) === null || _e === void 0 ? void 0 : _e.set(key, value);\n        }\n    }\n    delete({ namespace, key, parameter: param }) {\n        var _a, _b, _c, _d;\n        if (param) {\n            if ((_b = (_a = this.paramSubscriptions.get(namespace)) === null || _a === void 0 ? void 0 : _a.get(key)) === null || _b === void 0 ? void 0 : _b.delete(param)) {\n                if (this.paramSubscriptions.get(namespace).get(key).size < 1) {\n                    (_c = this.paramSubscriptions.get(namespace)) === null || _c === void 0 ? void 0 : _c.delete(key);\n                    if (this.paramSubscriptions.get(namespace).size < 1) {\n                        this.paramSubscriptions.delete(namespace);\n                    }\n                }\n            }\n        }\n        else {\n            if ((_d = this.simpleSubscriptions.get(namespace)) === null || _d === void 0 ? void 0 : _d.delete(key)) {\n                if (this.simpleSubscriptions.get(namespace).size < 1) {\n                    this.simpleSubscriptions.delete(namespace);\n                }\n            }\n        }\n    }\n    get({ namespace, key, parameter: param }) {\n        var _a, _b, _c;\n        if (!param) {\n            return (_a = this.simpleSubscriptions.get(namespace)) === null || _a === void 0 ? void 0 : _a.get(key);\n        }\n        else {\n            return (_c = (_b = this.paramSubscriptions.get(namespace)) === null || _b === void 0 ? void 0 : _b.get(key)) === null || _c === void 0 ? void 0 : _c.get(param);\n        }\n    }\n    getOrAdd(topic, addFactory) {\n        let value = this.get(topic);\n        if (!value) {\n            value = addFactory();\n            this.add(topic, value);\n        }\n        return value;\n    }\n    addOrUpdate(topic, addFactory, updateAction) {\n        let value = this.get(topic);\n        if (value) {\n            value = updateAction(value);\n        }\n        else {\n            value = addFactory();\n        }\n        this.add(topic, value);\n        return value;\n    }\n    getAllSubscriptions() {\n        const noParam = Array.from(this.simpleSubscriptions.keys()).flatMap((namespace) => Array.from(this.simpleSubscriptions.get(namespace).keys()).flatMap((key) => ({\n            namespace,\n            key,\n        })));\n        const withParam = Array.from(this.paramSubscriptions.keys()).flatMap((namespace) => Array.from(this.paramSubscriptions.get(namespace).keys()).flatMap((key) => Array.from(this.paramSubscriptions.get(namespace).get(key).keys()).flatMap((parameter) => ({\n            namespace,\n            key,\n            parameter,\n        }))));\n        return [...noParam, ...withParam];\n    }\n}\n//# sourceMappingURL=subscription-map.js.map","import { SubscriptionHandlerIdMap } from \"./subscription-handler-id-map\";\nimport { SubscriptionMap } from \"./subscription-map\";\nexport class SubscriptionManager {\n    constructor() {\n        this.subscriptions = new SubscriptionMap();\n    }\n    add(topic, handler) {\n        return this.subscriptions\n            .getOrAdd(topic, () => new SubscriptionHandlerIdMap())\n            .add(handler);\n    }\n    get(topic) {\n        var _a, _b;\n        return (_b = (_a = this.subscriptions.get(topic)) === null || _a === void 0 ? void 0 : _a.get()) !== null && _b !== void 0 ? _b : [];\n    }\n    getById(topic, handlerId) {\n        var _a, _b;\n        return (_b = (_a = this.subscriptions.get(topic)) === null || _a === void 0 ? void 0 : _a.getHandlerById(handlerId)) !== null && _b !== void 0 ? _b : null;\n    }\n    delete(topic, handler) {\n        var _a, _b;\n        if ((_b = (_a = this.subscriptions.get(topic)) === null || _a === void 0 ? void 0 : _a.delete(handler).isEmpty) !== null && _b !== void 0 ? _b : false) {\n            this.subscriptions.delete(topic);\n        }\n    }\n    size(topic) {\n        var _a, _b;\n        return (_b = (_a = this.subscriptions.get(topic)) === null || _a === void 0 ? void 0 : _a.size()) !== null && _b !== void 0 ? _b : 0;\n    }\n    isEmpty(topic) {\n        return this.size(topic) === 0;\n    }\n    getAllSubscriptions() {\n        return this.subscriptions.getAllSubscriptions();\n    }\n    getAllSubscriptionHandlerIds() {\n        return this.subscriptions\n            .getAllSubscriptions()\n            .reduce((acc, topic) => acc.concat(this.get(topic).map(({ handlerId }) => ({\n            topic,\n            handlerId,\n        }))), []);\n    }\n}\n//# sourceMappingURL=subscription-manager.js.map","/**\n * @classdesc DurationMetricRecorder class provides APIs to emit duration metrics based on users' need\n */\nexport class DurationMetricRecorder {\n    /**\n     * Constructor for DurationMetricRecorder\n     * @param {(metric: MetricData) => void} sendMetric- The method that sends metric\n     * @param {string} metricName - The name of the duration metric\n     * @param {Record<string, string>} dimensions - The dimensions of the duration metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of the duration metric with keys and values (optional)\n     */\n    constructor({ sendMetric, metricName, metricOptions, }) {\n        this.unit = \"Milliseconds\";\n        this.sendMetric = sendMetric;\n        this.startTime = performance.now();\n        this.metricName = metricName;\n        this.dimensions = (metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.dimensions) ? metricOptions.dimensions : {};\n        this.optionalDimensions = (metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.optionalDimensions)\n            ? metricOptions.optionalDimensions\n            : {};\n    }\n    /**\n     * Stop recording of the duration metric and emit it\n     * @returns {durationCount: number} - The duration being recorded\n     */\n    stopDurationCounter() {\n        const durationResult = Math.round(performance.now() - this.startTime);\n        this.sendMetric({\n            metricName: this.metricName,\n            unit: this.unit,\n            value: durationResult,\n            dimensions: this.dimensions,\n            optionalDimensions: this.optionalDimensions,\n        });\n        return { duration: durationResult };\n    }\n}\n//# sourceMappingURL=duration-metric-recorder.js.map","export const MAX_METRIC_DIMENSIONS = 30;\n/**\n * Check if the the sum of the length of dimensions and optional dimentions is exceeding maximum dimension length acceptable by back-end\n * @param {Record<string, string>} dimensions - The dimensions of the duration metric with keys and values\n * @param {Record<string, string>} optionalDimensions -The optional dimensions of the duration metric with keys and values\n */\nexport function checkDimensionLength(dimensions, optionalDimensions) {\n    if (Object.keys(dimensions).length +\n        Object.keys(optionalDimensions !== null && optionalDimensions !== void 0 ? optionalDimensions : {}).length >\n        MAX_METRIC_DIMENSIONS) {\n        throw new Error(\"Cannot add more than 30 dimensions to a metric\");\n    }\n}\n/**\n * Transform the metric message into the format acceptable by back-end\n * @param {MetricData} metricData - The metric data\n * @param {string} timestamp - The timestamp of the metric\n * @param {string} namespace - The namespace of the metric\n * @param {UpstreamMessageOrigin} messageOrigin - The origin of the metric message\n * @return {MetricMessage} - Return a MetricMessage object\n */\nexport function createMetricMessage({ metricData, time, namespace }, messageOrigin) {\n    var _a, _b;\n    return {\n        type: \"metric\",\n        namespace: namespace,\n        metricName: metricData.metricName,\n        unit: metricData.unit,\n        value: metricData.value,\n        time: time,\n        dimensions: (_a = metricData.dimensions) !== null && _a !== void 0 ? _a : {},\n        optionalDimensions: (_b = metricData.optionalDimensions) !== null && _b !== void 0 ? _b : {},\n        messageOrigin,\n    };\n}\n//# sourceMappingURL=metric-helpers.js.map","import { getGlobalProvider } from \"../provider\";\nimport { DurationMetricRecorder } from \"./duration-metric-recorder\";\nimport { checkDimensionLength } from \"./metric-helpers\";\n/**\n * @classdesc ConnectMetricRecorder class provides APIs to emit metrics based on users' need\n */\nexport class ConnectMetricRecorder {\n    /**\n     * Constructor for ConnectMetricRecorder\n     * @param {ConnectRecorderMetricParams} params - The namespace and provider(optional)\n     */\n    constructor(params) {\n        this._proxy = null;\n        this.namespace = params.namespace;\n        if (params.provider && typeof params.provider === \"function\")\n            this.providerFactory = params.provider;\n        else\n            this.provider = params.provider;\n    }\n    /**\n     * Emit a metric that counts success\n     * @param {string} metricName - The name of the metric\n     * @param {Record<string, string>} dimensions - The dimensions of a metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of a metric with keys and values (optional)\n     */\n    recordSuccess(metricName, metricOptions) {\n        var _a;\n        const processedDimensions = Object.assign({}, ((_a = metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.dimensions) !== null && _a !== void 0 ? _a : {}));\n        const processedMetricOptions = Object.assign(Object.assign({}, metricOptions), { dimensions: processedDimensions });\n        this.recordCount(metricName, 0, processedMetricOptions);\n    }\n    /**\n     * Emit a metric that counts error. Add default dimension { name: \"Metric\", value: \"Error\" } to the metric if not added\n     * @param {string} metricName - The name of the metric\n     * @param {Record<string, string>} dimensions - The dimensions of a metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of a metric with keys and values (optional)\n     */\n    recordError(metricName, metricOptions) {\n        var _a;\n        const processedDimensions = Object.assign({}, ((_a = metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.dimensions) !== null && _a !== void 0 ? _a : {}));\n        const processedMetricOptions = Object.assign(Object.assign({}, metricOptions), { dimensions: processedDimensions });\n        this.recordCount(metricName, 1, processedMetricOptions);\n    }\n    /**\n     * Emit a counting metric\n     * @param {string} metricName - The name of the metric\n     * @param {number} count - The count of the metric\n     * @param {Record<string, string>} dimensions - The dimensions of a metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of a metric with keys and values (optional)\n     */\n    recordCount(metricName, count, metricOptions) {\n        this.sendMetric({\n            metricName,\n            unit: \"Count\",\n            value: count,\n            dimensions: metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.dimensions,\n            optionalDimensions: metricOptions === null || metricOptions === void 0 ? void 0 : metricOptions.optionalDimensions,\n        });\n    }\n    /**\n     * Start a duration metric\n     * @param {string} metricName - The name of the metric\n     * @param {Record<string, string>} dimensions - The dimensions of a metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of a metric with keys and values (optional)\n     * @returns {DurationMetricRecorder} - The DurationMetricRecorder object being created\n     */\n    startDurationCounter(metricName, metricOptions) {\n        return new DurationMetricRecorder({\n            sendMetric: this.sendMetric.bind(this),\n            metricName,\n            metricOptions,\n        });\n    }\n    /**\n     * Emit metric\n     * @param {string} metricName - The name of the metric\n     * @param {unit} unit - The unit of the metric\n     * @param {number} value - The value of the metric\n     * @param {Record<string, string>} dimensions - The dimensions of a metric with keys and values (optional)\n     * @param {Record<string, string>} optionalDimensions - The optional dimensions of a metric with keys and values (optional)\n     */\n    sendMetric({ metricName, unit, value, dimensions, optionalDimensions, }) {\n        if (dimensions) {\n            checkDimensionLength(dimensions, optionalDimensions);\n        }\n        const metricData = {\n            metricName,\n            unit,\n            value,\n            dimensions,\n            optionalDimensions,\n        };\n        const time = new Date();\n        this.getProxy().sendMetric({\n            metricData,\n            time,\n            namespace: this.namespace,\n        });\n    }\n    /**\n     * Get the provider of the ConnectMetricRecorder instance\n     */\n    getProvider() {\n        if (!this.provider) {\n            this.provider = this.providerFactory\n                ? this.providerFactory()\n                : getGlobalProvider();\n        }\n        return this.provider;\n    }\n    /**\n     * Get the proxy of the ConnectMetricRecorder instance\n     */\n    getProxy() {\n        if (!this._proxy) {\n            this._proxy = this.getProvider().getProxy();\n        }\n        return this._proxy;\n    }\n}\n//# sourceMappingURL=connect-metric-recorder.js.map","export const clientTimeoutResponseErrorKey = \"clientTimeout\";\nexport function formatClientTimeoutError(request, timeoutMs) {\n    const { namespace, command, data: requestData } = request;\n    return {\n        namespace,\n        reason: \"Client Timeout\",\n        details: {\n            command,\n            requestData,\n            timeoutMs,\n        },\n        errorKey: clientTimeoutResponseErrorKey,\n    };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function isClientTimeoutResponseError(err) {\n    return (\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    typeof err === \"object\" && err.errorKey === clientTimeoutResponseErrorKey);\n}\n//# sourceMappingURL=client-timeout-error.js.map","import { ConnectError } from \"../error\";\nimport { formatClientTimeoutError } from \"./client-timeout-error\";\nconst DEFAULT_TIMEOUT_MS = 30 * 1000;\nexport function createRequestHandler(request, onStart, onTimeout, timeoutMs) {\n    const adjustedTimeoutMs = Math.max(1, timeoutMs !== null && timeoutMs !== void 0 ? timeoutMs : DEFAULT_TIMEOUT_MS);\n    return new Promise((resolve, reject) => {\n        let isTimedOut = false;\n        const timeout = setTimeout(() => {\n            onTimeout({ timeoutMs: adjustedTimeoutMs, request });\n            // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\n            reject(formatClientTimeoutError(request, adjustedTimeoutMs));\n            isTimedOut = true;\n        }, adjustedTimeoutMs);\n        const handler = (msg) => {\n            clearTimeout(timeout);\n            if (!isTimedOut) {\n                if (msg.isError) {\n                    reject(new ConnectError(msg));\n                }\n                else {\n                    resolve(msg.data);\n                }\n            }\n        };\n        onStart(handler);\n    });\n}\n//# sourceMappingURL=request-handler-factory.js.map","import { ConnectLogger } from \"../logging\";\nimport { createRequestHandler, } from \"./request-handler-factory\";\nexport class RequestManager {\n    constructor(provider) {\n        this.requestMap = new Map();\n        this.logger = new ConnectLogger({\n            provider,\n            source: \"core.requestManager\",\n        });\n    }\n    processRequest(request) {\n        const { requestId } = request;\n        return createRequestHandler(request, (handler) => this.requestMap.set(requestId, handler), ({ request, timeoutMs }) => this.handleTimeout(request, timeoutMs));\n    }\n    processResponse(response) {\n        const { requestId } = response;\n        const handler = this.requestMap.get(requestId);\n        if (!handler) {\n            // The proxy is implemented such that this should never happen\n            this.logger.error(\"Returned a response message with no handler\", {\n                message: response,\n            });\n            return;\n        }\n        handler(response);\n        this.requestMap.delete(requestId);\n    }\n    handleTimeout(request, timeoutMs) {\n        const { requestId, namespace, command } = request;\n        this.requestMap.delete(requestId);\n        this.logger.error(\"Client request timeout\", {\n            requestId,\n            namespace,\n            command,\n            timeoutMs,\n        });\n    }\n}\n//# sourceMappingURL=request-manager.js.map","import { generateUUID } from \"../utility\";\nexport function createRequestMessage(namespace, command, data, messageOrigin) {\n    const requestId = generateUUID();\n    return {\n        type: \"request\",\n        namespace,\n        command,\n        requestId,\n        data,\n        messageOrigin,\n    };\n}\n//# sourceMappingURL=request-message-factory.js.map","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nexport function sanitizeDownstreamMessage(message) {\n    try {\n        switch (message.type) {\n            case \"acknowledge\":\n            case \"error\":\n            case \"childConnectionClose\":\n                return message;\n            case \"childDownstreamMessage\":\n                return Object.assign(Object.assign({}, message), { message: sanitizeDownstreamMessage(message.message) });\n            case \"publish\": {\n                const { data } = message, other = __rest(message, [\"data\"]);\n                return Object.assign({}, other);\n            }\n            case \"response\": {\n                if (message.isError)\n                    return Object.assign(Object.assign({}, message), { details: { command: message.details.command } });\n                else {\n                    const { data } = message, other = __rest(message, [\"data\"]);\n                    return Object.assign({}, other);\n                }\n            }\n            default:\n                return message;\n        }\n    }\n    catch (error) {\n        return {\n            messageDetails: \"error when sanitizing downstream message\",\n            message,\n            error,\n        };\n    }\n}\n//# sourceMappingURL=downstream-message-sanitizer.js.map","import { ConnectLogger } from \"../logging\";\nimport { sanitizeDownstreamMessage, } from \"../messaging\";\n/**\n * Manages communication channels between the proxy and child entities.\n *\n * The ChannelManager supports two types of communication channels:\n * 1. Iframe channels - Use browser MessagePort API for communication across different execution contexts\n * 2. Component channels - Use direct function calls when both entities exist in the same execution context\n *\n * Key responsibilities:\n * - Adding and removing child channels\n * - Routing downstream messages from proxy to child entities\n * - Relaying upstream messages from child entities back to the proxy\n * - Managing MessagePort lifecycle (opening, closing, cleanup)\n * - Validating provider IDs to ensure secure message routing\n *\n * @example Iframe Channel\n * ```typescript\n * const { port1, port2 } = new MessageChannel();\n * channelManager.addChannel({\n *   connectionId: \"child-uuid\",\n *   providerId: \"provider-uuid\",\n *   type: \"iframe\",\n *   port: port1\n * });\n * // port2 gets transferred to child entity\n * ```\n *\n * @example Component Channel\n * ```typescript\n * channelManager.addChannel({\n *   connectionId: \"child-uuid\",\n *   providerId: \"provider-uuid\",\n *   type: \"component\",\n *   sendDownstreamMessage: (msg) => childEntity.receive(msg),\n *   setUpstreamMessageHandler: (handler) => childEntity.onUpstream = handler\n * });\n * ```\n */\nexport class ChannelManager {\n    constructor(provider, relayChildUpstreamMessage) {\n        this.provider = provider;\n        this.relayChildUpstreamMessage = relayChildUpstreamMessage;\n        this.channels = new Map();\n        this.logger = new ConnectLogger({\n            provider,\n            source: \"childConnectionManager\",\n        });\n    }\n    /**\n     * Adds a new communication channel for a child entity.\n     *\n     * Supports both iframe and component channel types. For iframe channels,\n     * sets up message event listeners and starts the port. For component channels,\n     * configures the upstream message handler. Both types send a \"childConnectionReady\"\n     * message upstream to notify the proxy that the channel is established.\n     *\n     * @param params - Channel configuration parameters\n     * @param params.connectionId - UUID identifier for this channel connection\n     * @param params.providerId - UUID of the provider that owns this channel\n     * @param params.type - Channel type: \"iframe\" or \"component\"\n     *\n     * @example Iframe Channel\n     * ```typescript\n     * const { port1, port2 } = new MessageChannel();\n     * channelManager.addChannel({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440000\",\n     *   providerId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n     *   type: \"iframe\",\n     *   port: port1\n     * });\n     * ```\n     *\n     * @example Component Channel\n     * ```typescript\n     * channelManager.addChannel({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440001\",\n     *   providerId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n     *   type: \"component\",\n     *   sendDownstreamMessage: (msg) => childEntity.receive(msg),\n     *   setUpstreamMessageHandler: (handler) => childEntity.onUpstream = handler\n     * });\n     * ```\n     */\n    addChannel(params) {\n        const { connectionId } = params;\n        if (this.channels.has(connectionId)) {\n            this.logger.error(\"Attempted to add child connection that already exists. No action\", {\n                connectionId,\n            });\n            return;\n        }\n        if (params.type === \"iframe\") {\n            this.setupIframe(params);\n        }\n        else {\n            this.setupComponent(params);\n        }\n        this.logger.debug(\"Child channel added\", {\n            connectionId,\n            type: params.type,\n        });\n    }\n    /**\n     * Updates an existing MessagePort channel with a new MessagePort.\n     *\n     * This method is only applicable to MessagePort channels. Direct channels cannot\n     * be updated and will result in an error. The old MessagePort is properly cleaned up\n     * (event listeners removed, port closed) before the new port is configured.\n     *\n     * @param params - Update parameters\n     * @param params.connectionId - UUID identifier for the channel to update\n     * @param params.port - New MessagePort instance to replace the existing one\n     * @param params.providerId - UUID of the provider that owns this channel\n     *\n     * @throws Logs error if connectionId doesn't exist or channel is Direct type\n     *\n     * @example\n     * ```typescript\n     * const { port1, port2 } = new MessageChannel();\n     * channelManager.updateChannelPort({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440000\",\n     *   port: port1,\n     *   providerId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\"\n     * });\n     * ```\n     */\n    updateChannelPort(params) {\n        const { connectionId } = params;\n        const existingChannel = this.channels.get(connectionId);\n        if (!existingChannel) {\n            this.logger.error(\"Attempted to update child connection that does not exist No action\", {\n                connectionId,\n            });\n            return;\n        }\n        if (existingChannel.type === \"component\") {\n            this.logger.error(\"Attempted to update a component channel connection as MessagePort. This is not supported.\", {\n                connectionId,\n            });\n            return;\n        }\n        const originalChannel = existingChannel;\n        originalChannel.port.onmessage = null;\n        originalChannel.port.close();\n        const setupParams = Object.assign(Object.assign({}, params), { type: \"iframe\" });\n        this.setupIframe(setupParams);\n        this.logger.info(\"Updated child port\", { connectionId });\n    }\n    setupIframe(params) {\n        const { connectionId, port, providerId } = params;\n        const handler = this.createMessageHandler(connectionId, providerId);\n        port.addEventListener(\"message\", handler);\n        port.start();\n        this.channels.set(connectionId, {\n            type: \"iframe\",\n            port,\n            handler,\n            providerId,\n        });\n        this.relayChildUpstreamMessage({\n            type: \"childUpstream\",\n            connectionId,\n            sourceProviderId: providerId,\n            parentProviderId: this.provider.id,\n            message: {\n                type: \"childConnectionReady\",\n            },\n        });\n    }\n    setupComponent(params) {\n        const { connectionId, providerId, sendDownstreamMessage, setUpstreamMessageHandler, } = params;\n        const upstreamHandler = (message) => {\n            this.relayChildUpstreamMessage({\n                type: \"childUpstream\",\n                sourceProviderId: providerId,\n                parentProviderId: this.provider.id,\n                connectionId,\n                message,\n            });\n        };\n        setUpstreamMessageHandler(upstreamHandler);\n        this.channels.set(connectionId, {\n            type: \"component\",\n            providerId,\n            sendDownstreamMessage,\n            setUpstreamMessageHandler,\n        });\n        this.relayChildUpstreamMessage({\n            type: \"childUpstream\",\n            connectionId,\n            sourceProviderId: providerId,\n            parentProviderId: this.provider.id,\n            message: {\n                type: \"childConnectionReady\",\n            },\n        });\n    }\n    /**\n     * Routes a downstream message from the proxy to the appropriate child channel.\n     *\n     * Validates that the target channel exists and that the provider ID matches\n     * (for security). For MessagePort channels, uses postMessage(). For Direct\n     * channels, calls the sendDownstreamMessage function.\n     *\n     * @param params - Downstream message parameters\n     * @param params.connectionId - UUID of the target channel\n     * @param params.message - The message to send to the child entity\n     * @param params.targetProviderId - Expected provider ID for validation\n     *\n     * @example\n     * ```typescript\n     * channelManager.handleDownstreamMessage({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440000\",\n     *   message: { type: \"request\", data: \"some data\" },\n     *   targetProviderId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\"\n     * });\n     * ```\n     */\n    handleDownstreamMessage({ connectionId, message, targetProviderId, }) {\n        const channelData = this.channels.get(connectionId);\n        if (!channelData) {\n            this.logger.warn(\"Attempted to route downstream message to child channel that does not exist\", { connectionId, message: sanitizeDownstreamMessage(message) });\n            return;\n        }\n        const { providerId } = channelData;\n        // Older versions of the SDK do not provide a provider id. This\n        // check is ignored for versions without a providerId.\n        if (providerId && providerId !== targetProviderId) {\n            this.logger.error(\"Downstream target message did not match target provider id. Not sending message.\", {\n                connectionId,\n                targetProviderId,\n                actualProviderId: providerId,\n                message: sanitizeDownstreamMessage(message),\n            });\n            return;\n        }\n        if (channelData.type === \"iframe\") {\n            channelData.port.postMessage(message);\n        }\n        else {\n            channelData.sendDownstreamMessage(message);\n        }\n    }\n    /**\n     * Handles closing a child channel and performs appropriate cleanup.\n     *\n     * For MessagePort channels, removes event listeners and closes the port.\n     * For Direct channels, simply removes the channel from the internal map\n     * since no port cleanup is needed. The channel is always removed from\n     * the channels map regardless of type.\n     *\n     * @param params - Close message parameters\n     * @param params.connectionId - UUID of the channel to close\n     *\n     * @example\n     * ```typescript\n     * channelManager.handleCloseMessage({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440000\"\n     * });\n     * ```\n     */\n    handleCloseMessage({ connectionId }) {\n        const channelData = this.channels.get(connectionId);\n        if (!channelData) {\n            this.logger.warn(\"Attempted to close child channel that was not found\", {\n                connectionId,\n            });\n            return;\n        }\n        if (channelData.type === \"iframe\") {\n            const { port, handler } = channelData;\n            port.removeEventListener(\"message\", handler);\n            port.close();\n        }\n        // For component channels, no cleanup of ports/handlers is needed\n        this.channels.delete(connectionId);\n        this.logger.debug(\"Removed child channel\", {\n            connectionId,\n            type: channelData.type,\n        });\n    }\n    createMessageHandler(connectionId, providerId) {\n        return (message) => this.relayChildUpstreamMessage({\n            type: \"childUpstream\",\n            sourceProviderId: providerId,\n            parentProviderId: this.provider.id,\n            connectionId,\n            message: message.data,\n        });\n    }\n}\n//# sourceMappingURL=channel-manager.js.map","import { ConnectLogger } from \"../../logging\";\nexport class ErrorService {\n    constructor(provider) {\n        this.errorHandlers = new Set();\n        this.logger = new ConnectLogger({\n            provider,\n            source: \"core.proxy.error\",\n        });\n    }\n    invoke(error) {\n        const { message, key, details, isFatal, connectionStatus } = error;\n        this.logger.error(message, {\n            key,\n            details,\n            isFatal,\n            connectionStatus,\n        }, { duplicateMessageToConsole: true, remoteIgnore: true });\n        [...this.errorHandlers].forEach((handler) => {\n            try {\n                handler(error);\n            }\n            catch (handlerError) {\n                this.logger.error(\"An error occurred within a AmazonConnectErrorHandler\", {\n                    handlerError,\n                    originalError: error,\n                });\n            }\n        });\n    }\n    onError(handler) {\n        this.errorHandlers.add(handler);\n    }\n    offError(handler) {\n        this.errorHandlers.delete(handler);\n    }\n}\n//# sourceMappingURL=error-service.js.map","import { ConnectLogger } from \"../../logging\";\nimport { AsyncEventEmitter } from \"../../utility\";\nexport class HealthCheckManager {\n    constructor({ provider, sendHealthCheck, getUpstreamMessageOrigin, }) {\n        this.connectionId = null;\n        this.healthCheckInterval = null;\n        this.healthCheckTimeout = null;\n        this.sendHealthCheck = sendHealthCheck;\n        this.getUpstreamMessageOrigin = getUpstreamMessageOrigin;\n        this.sendHealthCheckInterval = null;\n        this.lastHealthCheckResponse = null;\n        this._status = \"unknown\";\n        this.logger = new ConnectLogger({\n            source: \"core.proxy.health-check\",\n            provider: provider,\n            mixin: () => ({\n                connectionId: this.connectionId,\n            }),\n        });\n        this.events = new AsyncEventEmitter({\n            provider,\n            loggerKey: \"core.proxy.health-check\",\n        });\n    }\n    get status() {\n        return this._status;\n    }\n    get isRunning() {\n        return this.sendHealthCheckInterval !== null;\n    }\n    get lastCheckCounter() {\n        var _a, _b;\n        return (_b = (_a = this.lastHealthCheckResponse) === null || _a === void 0 ? void 0 : _a.counter) !== null && _b !== void 0 ? _b : null;\n    }\n    get lastCheckTime() {\n        var _a, _b;\n        return (_b = (_a = this.lastHealthCheckResponse) === null || _a === void 0 ? void 0 : _a.time) !== null && _b !== void 0 ? _b : null;\n    }\n    start({ healthCheckInterval: interval, connectionId, }) {\n        this.connectionId = connectionId;\n        this.healthCheckInterval = interval;\n        this.clearInterval();\n        if (interval <= 0) {\n            this.logger.debug(\"Health check disabled\");\n            return;\n        }\n        if (interval < 1000) {\n            this.logger.error(\"Health check interval is less than 1 second. Not running\", { interval });\n            return;\n        }\n        this.sendHealthCheckMessage();\n        this.sendHealthCheckInterval = setInterval(() => this.sendHealthCheckMessage(), interval);\n        this.startTimeout();\n    }\n    stop() {\n        this.clearInterval();\n        this.clearTimeout();\n    }\n    handleResponse(message) {\n        this.setHealthy({\n            time: message.time,\n            counter: message.counter,\n        });\n    }\n    sendHealthCheckMessage() {\n        this.sendHealthCheck({\n            type: \"healthCheck\",\n            messageOrigin: this.getUpstreamMessageOrigin(),\n        });\n    }\n    startTimeout() {\n        if (!this.healthCheckInterval) {\n            this.logger.error(\"Health check interval not set. Cannot start timeout\");\n            return;\n        }\n        // Cancels a preexisting timeout to be replaced with new timeout\n        this.clearTimeout();\n        this.healthCheckTimeout = setTimeout(() => {\n            this.setUnhealthy();\n        }, this.healthCheckInterval * 3);\n    }\n    clearInterval() {\n        if (this.sendHealthCheckInterval) {\n            clearInterval(this.sendHealthCheckInterval);\n            this.sendHealthCheckInterval = null;\n        }\n    }\n    clearTimeout() {\n        if (this.healthCheckTimeout) {\n            clearTimeout(this.healthCheckTimeout);\n            this.healthCheckTimeout = null;\n        }\n    }\n    setUnhealthy() {\n        if (this._status !== \"unhealthy\") {\n            const previousStatus = this._status;\n            this.logger.info(\"Connection unhealthy\", {\n                previousStatus,\n            });\n            this._status = \"unhealthy\";\n            this.emitStatusChanged(\"unhealthy\", previousStatus);\n        }\n    }\n    setHealthy(result) {\n        this.lastHealthCheckResponse = Object.assign({}, result);\n        if (this._status !== \"healthy\") {\n            const previousStatus = this._status;\n            this.logger.debug(\"Connection healthy\", {\n                previousStatus,\n            });\n            this._status = \"healthy\";\n            this.emitStatusChanged(\"healthy\", previousStatus);\n        }\n        this.startTimeout();\n    }\n    emitStatusChanged(status, previousStatus) {\n        var _a, _b, _c, _d;\n        void this.events.emit(HealthCheckManager.statusChangedKey, {\n            status,\n            previousStatus,\n            lastCheckTime: (_b = (_a = this.lastHealthCheckResponse) === null || _a === void 0 ? void 0 : _a.time) !== null && _b !== void 0 ? _b : null,\n            lastCheckCounter: (_d = (_c = this.lastHealthCheckResponse) === null || _c === void 0 ? void 0 : _c.counter) !== null && _d !== void 0 ? _d : null,\n        });\n    }\n    onStatusChanged(handler) {\n        this.events.on(HealthCheckManager.statusChangedKey, handler);\n    }\n    offStatusChanged(handler) {\n        this.events.off(HealthCheckManager.statusChangedKey, handler);\n    }\n}\nHealthCheckManager.statusChangedKey = \"statusChanged\";\n//# sourceMappingURL=health-check-manager.js.map","import { ConnectLogger } from \"../../logging\";\nexport class ProxyConnectionStatusManager {\n    constructor(provider) {\n        this.status = \"notConnected\";\n        this.changeHandlers = new Set();\n        this.logger = new ConnectLogger({\n            source: \"core.proxy.connection-status-manager\",\n            provider,\n            mixin: () => ({ status: this.status }),\n        });\n    }\n    getStatus() {\n        return this.status;\n    }\n    update(evt) {\n        this.status = evt.status;\n        this.logger.trace(\"Proxy Connection Status Changed\", {\n            status: evt.status,\n        });\n        [...this.changeHandlers].forEach((handler) => {\n            try {\n                handler(evt);\n            }\n            catch (error) {\n                this.logger.error(\"An error occurred within a ProxyConnectionChangedHandler\", { error });\n            }\n        });\n    }\n    onChange(handler) {\n        this.changeHandlers.add(handler);\n    }\n    offChange(handler) {\n        this.changeHandlers.delete(handler);\n    }\n}\n//# sourceMappingURL=proxy-connection-status-manager.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { ConnectLogger, createLogMessage, } from \"../logging\";\nimport { SubscriptionManager, } from \"../messaging/subscription\";\nimport { createMetricMessage } from \"../metric\";\nimport { createRequestMessage, RequestManager, } from \"../request\";\nimport { ChannelManager } from \"./channel-manager\";\nimport { ErrorService } from \"./error\";\nimport { HealthCheckManager, } from \"./health-check\";\nimport { ProxyConnectionStatusManager, } from \"./proxy-connection\";\nexport class Proxy {\n    constructor(provider) {\n        this.provider = provider;\n        this.logger = new ConnectLogger({\n            source: \"core.proxy\",\n            provider,\n            mixin: () => ({\n                proxyType: this.proxyType,\n                connectionId: this.connectionId,\n            }),\n        });\n        this.requestManager = new RequestManager(provider);\n        this.status = new ProxyConnectionStatusManager(provider);\n        this.errorService = new ErrorService(provider);\n        this.upstreamMessageQueue = [];\n        this.connectionEstablished = false;\n        this.isInitialized = false;\n        this.subscriptions = new SubscriptionManager();\n        this.connectionId = null;\n        this.channelManager = new ChannelManager(provider, this.sendOrQueueMessageToSubject.bind(this));\n        this.healthCheck = new HealthCheckManager({\n            provider,\n            sendHealthCheck: this.sendOrQueueMessageToSubject.bind(this),\n            getUpstreamMessageOrigin: this.getUpstreamMessageOrigin.bind(this),\n        });\n    }\n    init() {\n        if (this.isInitialized)\n            throw new Error(\"Proxy already initialized\");\n        this.isInitialized = true;\n        this.initProxy();\n    }\n    request(namespace, command, data, origin) {\n        const msg = createRequestMessage(namespace, command, data, origin !== null && origin !== void 0 ? origin : this.getUpstreamMessageOrigin());\n        const resp = this.requestManager.processRequest(msg);\n        this.sendOrQueueMessageToSubject(msg);\n        return resp;\n    }\n    subscribe(topic, handler, origin) {\n        const { handlerId } = this.subscriptions.add(topic, handler);\n        const msg = {\n            type: \"subscribe\",\n            topic,\n            messageOrigin: origin !== null && origin !== void 0 ? origin : this.getUpstreamMessageOrigin(),\n            handlerId,\n        };\n        this.sendOrQueueMessageToSubject(msg);\n    }\n    unsubscribe(topic, handler, origin) {\n        this.subscriptions.delete(topic, handler);\n        if (this.subscriptions.isEmpty(topic)) {\n            const msg = {\n                type: \"unsubscribe\",\n                topic,\n                messageOrigin: origin !== null && origin !== void 0 ? origin : this.getUpstreamMessageOrigin(),\n            };\n            this.sendOrQueueMessageToSubject(msg);\n        }\n    }\n    log(logData) {\n        const logMsg = createLogMessage(logData, this.addContextToLogger(), this.getUpstreamMessageOrigin());\n        this.sendOrQueueMessageToSubject(logMsg);\n    }\n    sendLogMessage(message) {\n        if (message.type !== \"log\") {\n            this.logger.error(\"Attempted to send invalid log message\", {\n                message,\n            });\n            return;\n        }\n        message.context = Object.assign(Object.assign({}, message.context), this.addContextToLogger());\n        this.sendOrQueueMessageToSubject(message);\n    }\n    sendMetric({ metricData, time, namespace }) {\n        const metricMessage = createMetricMessage({\n            metricData,\n            time,\n            namespace,\n        }, this.getUpstreamMessageOrigin());\n        this.sendOrQueueMessageToSubject(metricMessage);\n    }\n    sendMetricMessage(metricMessage) {\n        if (metricMessage.type !== \"metric\") {\n            this.logger.error(\"Attempted to send invalid metric message\", {\n                metricMessage,\n            });\n            return;\n        }\n        this.sendOrQueueMessageToSubject(metricMessage);\n    }\n    sendOrQueueMessageToSubject(message) {\n        if (this.connectionEstablished) {\n            this.sendMessageToSubject(message);\n        }\n        else {\n            this.upstreamMessageQueue.push(message);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    consumerMessageHandler(evt) {\n        if (!this.isInitialized) {\n            this.logger.error(\"Attempted to process message from subject prior to proxy being initializing. Message not processed\", { originalMessageEventData: evt.data });\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n        const { data } = evt;\n        if (!(\"type\" in data)) {\n            // TODO Clean this up... probably safe to ignore without logging\n            this.logger.warn(\"Unknown inbound message\", {\n                originalMessageEventData: data,\n            });\n            return;\n        }\n        // Naming of type confusing because outbound to worker is inbound to client\n        const msg = data;\n        this.handleMessageFromSubject(msg);\n    }\n    handleMessageFromSubject(msg) {\n        this.handleDefaultMessageFromSubject(msg);\n    }\n    handleDefaultMessageFromSubject(msg) {\n        switch (msg.type) {\n            case \"acknowledge\":\n                this.handleConnectionAcknowledge(msg);\n                break;\n            case \"response\":\n                this.handleResponse(msg);\n                break;\n            case \"publish\":\n                this.handlePublish(msg);\n                break;\n            case \"error\":\n                this.handleError(msg);\n                break;\n            case \"childDownstreamMessage\":\n                this.channelManager.handleDownstreamMessage(msg);\n                break;\n            case \"childConnectionClose\":\n                this.channelManager.handleCloseMessage(msg);\n                break;\n            case \"healthCheckResponse\":\n                this.healthCheck.handleResponse(msg);\n                break;\n            default:\n                this.logger.error(\"Unknown inbound message\", {\n                    originalMessageEventData: msg,\n                });\n                return;\n        }\n    }\n    handleConnectionAcknowledge(msg) {\n        this.connectionId = msg.connectionId;\n        this.logger.debug(\"Connection acknowledged by subject\", {\n            connectionId: msg.connectionId,\n            queuedMessageCount: this.upstreamMessageQueue.length,\n            status: msg.status,\n        });\n        this.status.update({\n            status: \"ready\",\n            connectionId: msg.connectionId,\n        });\n        this.connectionEstablished = true;\n        // Sends any messages in queue\n        while (this.upstreamMessageQueue.length) {\n            const msg = this.upstreamMessageQueue.shift();\n            this.sendMessageToSubject(msg);\n        }\n        this.healthCheck.start(msg);\n        this.logger.debug(\"Proxy connection ready\", {\n            connectionId: this.connectionId,\n        });\n    }\n    handleResponse(msg) {\n        this.requestManager.processResponse(msg);\n    }\n    handlePublish(msg) {\n        const { handlerId, topic } = msg;\n        if (handlerId) {\n            const handler = this.subscriptions.getById(topic, handlerId);\n            if (handler) {\n                void this.handleAsyncSubscriptionHandlerInvoke({ handler, handlerId }, msg);\n            }\n        }\n        else {\n            this.subscriptions\n                .get(topic)\n                .map((handlerIdMapping) => void this.handleAsyncSubscriptionHandlerInvoke(handlerIdMapping, msg));\n        }\n    }\n    handleError(msg) {\n        if (msg.isFatal) {\n            const { message: reason, type: _ } = msg, details = __rest(msg, [\"message\", \"type\"]);\n            this.status.update({ status: \"error\", reason: reason, details });\n        }\n        this.publishError({\n            message: msg.message,\n            key: msg.key,\n            details: msg.details,\n            isFatal: msg.isFatal,\n            proxyStatus: msg.status,\n        });\n    }\n    publishError(error) {\n        const fullError = Object.assign(Object.assign({}, error), { connectionStatus: this.connectionStatus });\n        this.errorService.invoke(fullError);\n    }\n    handleAsyncSubscriptionHandlerInvoke(_a, _b) {\n        return __awaiter(this, arguments, void 0, function* ({ handler, handlerId }, { topic, data }) {\n            try {\n                yield handler(data);\n            }\n            catch (error) {\n                this.logger.error(\"An error occurred when handling subscription\", {\n                    topic,\n                    error,\n                    handlerId,\n                });\n            }\n        });\n    }\n    get connectionStatus() {\n        return this.status.getStatus();\n    }\n    onError(handler) {\n        this.errorService.onError(handler);\n    }\n    offError(handler) {\n        this.errorService.offError(handler);\n    }\n    onConnectionStatusChange(handler) {\n        this.status.onChange(handler);\n    }\n    offConnectionStatusChange(handler) {\n        this.status.offChange(handler);\n    }\n    onHealthCheckStatusChanged(handler) {\n        this.healthCheck.onStatusChanged(handler);\n    }\n    offHealthCheckStatusChanged(handler) {\n        this.healthCheck.offStatusChanged(handler);\n    }\n    /**\n     * @deprecated Use addChildIframeChannel instead. This method will be removed in a future version.\n     */\n    addChildChannel(params) {\n        // Legacy method that only supports MessagePort channels\n        this.addChildIframeChannel(params);\n    }\n    /**\n     * Adds a component-based child channel to the proxy.\n     *\n     * This method establishes a communication channel using component function calls instead\n     * of MessagePorts. This is useful when both the proxy and child entity exist in the same\n     * execution context, such as within the same browser window or iframe.\n     *\n     * Component channels provide better performance than iframe channels since they avoid\n     * the overhead of serialization and can support synchronous communication patterns.\n     *\n     * @param params - Component channel configuration\n     * @param params.connectionId - UUID identifier for this channel connection\n     * @param params.providerId - UUID of the provider that owns this channel\n     * @param params.sendDownstreamMessage - Function to send messages to the child entity\n     * @param params.setUpstreamMessageHandler - Function to register upstream message handler\n     *\n     * @example\n     * ```typescript\n     * proxy.addChildComponentChannel({\n     *   connectionId: \"child-uuid\",\n     *   providerId: \"provider-uuid\",\n     *   sendDownstreamMessage: (message) => childComponent.receive(message),\n     *   setUpstreamMessageHandler: (handler) => childComponent.onUpstream = handler\n     * });\n     * ```\n     */\n    addChildIframeChannel(params) {\n        this.channelManager.addChannel(Object.assign(Object.assign({}, params), { type: \"iframe\" }));\n    }\n    /**\n     * Adds a component-based child channel for communication with child entities.\n     *\n     * This method establishes a communication channel using direct function calls instead\n     * of MessagePorts. This is useful when both the proxy and child entity exist in the same\n     * execution context and can directly reference each other's functions.\n     *\n     * @param params - Configuration parameters for the component function channel\n     * @param params.connectionId - Unique UUID identifier for this channel connection\n     * @param params.providerId - UUID of the provider that owns this channel connection\n     * @param params.sendDownstreamMessage - Function to send messages from proxy to child entity\n     * @param params.setUpstreamMessageHandler - Function to register handler for messages from child entity\n     *\n     * @example\n     * ```typescript\n     * // Child entity exposes these functions\n     * const childAPI = {\n     *   receive: (message) => { },\n     *   onUpstream: null as ((message) => void) | null\n     * };\n     *\n     * proxy.addChildComponentChannel({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440001\", // UUID\n     *   providerId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\", // UUID\n     *   sendDownstreamMessage: (message) => {\n     *     childAPI.receive(message);\n     *   },\n     *   setUpstreamMessageHandler: (handler) => {\n     *     childAPI.onUpstream = handler;\n     *   }\n     * });\n     * ```\n     */\n    addChildComponentChannel(params) {\n        this.channelManager.addChannel(Object.assign(Object.assign({}, params), { type: \"component\" }));\n    }\n    /**\n     * Updates an existing iframe channel with a new MessagePort.\n     *\n     * This method is only applicable to iframe channels. Component channels cannot\n     * be updated and will result in an error. The old MessagePort is properly cleaned up\n     * (event listeners removed, port closed) before the new port is configured.\n     *\n     * @param params - Update parameters\n     * @param params.connectionId - UUID identifier for the channel to update\n     * @param params.port - New MessagePort instance to replace the existing one\n     * @param params.providerId - UUID of the provider that owns this channel\n     *\n     * @example\n     * ```typescript\n     * const { port1, port2 } = new MessageChannel();\n     * proxy.updateChildIframeChannelPort({\n     *   connectionId: \"550e8400-e29b-41d4-a716-446655440000\",\n     *   port: port1,\n     *   providerId: \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\"\n     * });\n     * ```\n     */\n    updateChildIframeChannelPort(params) {\n        this.channelManager.updateChannelPort(params);\n    }\n    /**\n     * @deprecated Use updateChildIframeChannelPort instead. This method will be removed in a future version.\n     */\n    updateChildChannelPort(params) {\n        this.updateChildIframeChannelPort(params);\n    }\n    getConnectionId() {\n        if (this.connectionId)\n            return Promise.resolve(this.connectionId);\n        return new Promise((resolve, reject) => {\n            let timeout = undefined;\n            const handler = (evt) => {\n                if (evt.status === \"ready\") {\n                    this.offConnectionStatusChange(handler);\n                    clearInterval(timeout);\n                    resolve(evt.connectionId);\n                }\n            };\n            timeout = setTimeout(() => {\n                this.logger.error(\"Timeout getting connection id\");\n                this.offConnectionStatusChange(handler);\n                reject(new Error(\"Timeout getting connectionId\"));\n            }, 10 * 1000);\n            this.onConnectionStatusChange(handler);\n        });\n    }\n    resetConnection(reason) {\n        this.logger.debug(\"Resetting connection\", {\n            reason,\n            connectionId: this.connectionId,\n        });\n        this.connectionEstablished = false;\n        this.status.update({\n            status: \"reset\",\n            reason,\n        });\n        const { subscriptionHandlerCount } = this.restoreAllHandler();\n        this.logger.info(\"Resetting proxy\", {\n            reason,\n            subscriptionHandlerCount,\n        });\n        this.logger.debug(\"Connection reset complete, restoring handlers\", {\n            subscriptionHandlerCount,\n        });\n    }\n    restoreAllHandler() {\n        var _a;\n        const subscriptionHandlerIds = this.subscriptions.getAllSubscriptionHandlerIds();\n        // Restore all subscriptions\n        subscriptionHandlerIds === null || subscriptionHandlerIds === void 0 ? void 0 : subscriptionHandlerIds.map(({ topic, handlerId }) => ({\n            type: \"subscribe\",\n            topic,\n            messageOrigin: this.getUpstreamMessageOrigin(),\n            handlerId,\n        })).forEach((msg) => this.sendOrQueueMessageToSubject(msg));\n        return { subscriptionHandlerCount: (_a = subscriptionHandlerIds === null || subscriptionHandlerIds === void 0 ? void 0 : subscriptionHandlerIds.length) !== null && _a !== void 0 ? _a : -1 };\n    }\n    unsubscribeAllHandlers() {\n        var _a;\n        const subscriptionHandlerIds = this.subscriptions.getAllSubscriptionHandlerIds();\n        this.logger.info(\"Unsubscribing all handlers from proxy\", {\n            subscriptionHandlerCount: (_a = subscriptionHandlerIds === null || subscriptionHandlerIds === void 0 ? void 0 : subscriptionHandlerIds.length) !== null && _a !== void 0 ? _a : -1,\n        });\n        subscriptionHandlerIds === null || subscriptionHandlerIds === void 0 ? void 0 : subscriptionHandlerIds.map(({ topic }) => ({\n            type: \"unsubscribe\",\n            topic,\n            messageOrigin: this.getUpstreamMessageOrigin(),\n        })).forEach((msg) => this.sendOrQueueMessageToSubject(msg));\n    }\n}\n//# sourceMappingURL=proxy.js.map","import { ConnectLogger } from \"../logging\";\nexport class TimeoutTracker {\n    constructor(onCancelled, timeoutMs) {\n        this.timeoutMs = timeoutMs;\n        this.onCancelled = onCancelled;\n        this.timeout = setTimeout(() => this.handleCancel(), this.timeoutMs);\n        this.status = \"running\";\n        this.logger = new ConnectLogger({\n            source: \"core.utility.timeout-tracker\",\n            mixin: () => ({\n                timeoutMs: this.timeoutMs,\n                timeoutTrackerStatus: this.status,\n            }),\n        });\n    }\n    static start(onCancelled, ms) {\n        return new TimeoutTracker(onCancelled, ms);\n    }\n    complete() {\n        switch (this.status) {\n            case \"running\":\n                return this.handleComplete();\n            case \"completed\":\n                this.logger.debug(\"TimeoutTracker already marked complete. No action.\");\n                return true;\n            case \"cancelled\":\n                this.logger.info(\"Attempted to complete a TimeoutTracker that has already been cancelled\");\n                return false;\n        }\n    }\n    isCancelled() {\n        return this.status === \"cancelled\";\n    }\n    getStatus() {\n        return this.status;\n    }\n    handleCancel() {\n        switch (this.status) {\n            case \"running\":\n                this.status = \"cancelled\";\n                this.logger.info(\"TimeoutTracker has timed out. Invoking onCancelled Handler\");\n                this.invokeOnCancelled();\n                break;\n            case \"completed\":\n                this.logger.debug(\"Cancel operation for TimerTracker invoked after already completed. No action.\");\n                break;\n            default:\n                throw new Error(\"Cancel operation in TimerTracker called during an unexpected time.\");\n        }\n    }\n    handleComplete() {\n        this.status = \"completed\";\n        clearTimeout(this.timeout);\n        return true;\n    }\n    invokeOnCancelled() {\n        try {\n            this.onCancelled({ timeoutMs: this.timeoutMs });\n        }\n        catch (error) {\n            this.logger.error(\"Error when attempting to invoke TimeoutTrackerCancelledHandler\", { error });\n        }\n    }\n}\n//# sourceMappingURL=timeout-tracker.js.map","export var LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"trace\"] = 1] = \"trace\";\n    LogLevel[LogLevel[\"debug\"] = 2] = \"debug\";\n    LogLevel[LogLevel[\"info\"] = 3] = \"info\";\n    LogLevel[LogLevel[\"warn\"] = 4] = \"warn\";\n    LogLevel[LogLevel[\"error\"] = 5] = \"error\";\n})(LogLevel || (LogLevel = {}));\n//# sourceMappingURL=log-level.js.map","/* eslint-disable no-console */\nimport { LogLevel } from \"./log-level\";\nexport function logToConsole(level, message, data) {\n    if (data) {\n        switch (level) {\n            case LogLevel.error:\n                console.error(message, data);\n                break;\n            case LogLevel.warn:\n                console.warn(message, data);\n                break;\n            case LogLevel.info:\n                console.info(message, data);\n                break;\n            case LogLevel.debug:\n                console.debug(message, data);\n                break;\n            case LogLevel.trace:\n                console.trace(message, data);\n                break;\n            default:\n                console.log(message, data);\n                break;\n        }\n    }\n    else {\n        switch (level) {\n            case LogLevel.error:\n                console.error(message);\n                break;\n            case LogLevel.warn:\n                console.warn(message);\n                break;\n            case LogLevel.info:\n                console.info(message);\n                break;\n            case LogLevel.debug:\n                console.debug(message);\n                break;\n            case LogLevel.trace:\n                console.trace(message);\n                break;\n            default:\n                console.log(message);\n                break;\n        }\n    }\n}\n//# sourceMappingURL=log-data-console-writer.js.map","export class LogDataTransformer {\n    constructor(mixin) {\n        this.mixin = mixin;\n    }\n    getTransformedData(level, data) {\n        if (!this.mixin)\n            return data;\n        return Object.assign(Object.assign({}, (data !== null && data !== void 0 ? data : {})), this.mixin(data !== null && data !== void 0 ? data : {}, level));\n    }\n}\n//# sourceMappingURL=log-data-transformer.js.map","import { getGlobalProvider } from \"../provider\";\nimport { generateStringId } from \"../utility\";\nimport { logToConsole } from \"./log-data-console-writer\";\nimport { LogDataTransformer } from \"./log-data-transformer\";\nimport { LogLevel } from \"./log-level\";\nexport class ConnectLogger {\n    constructor(param) {\n        this._proxy = null;\n        this._logToConsoleLevel = null;\n        this.loggerId = generateStringId(8);\n        if (typeof param === \"string\") {\n            this.source = param;\n            this.dataTransformer = new LogDataTransformer(undefined);\n        }\n        else {\n            this.source = param.source;\n            if (param.provider && typeof param.provider === \"function\")\n                this.providerFactory = param.provider;\n            else\n                this.provider = param.provider;\n            this.dataTransformer = new LogDataTransformer(param.mixin);\n            this.logOptions = param.options;\n        }\n    }\n    trace(message, data, options) {\n        this.log(LogLevel.trace, message, data, options);\n    }\n    debug(message, data, options) {\n        this.log(LogLevel.debug, message, data, options);\n    }\n    info(message, data, options) {\n        this.log(LogLevel.info, message, data, options);\n    }\n    warn(message, data, options) {\n        this.log(LogLevel.warn, message, data, options);\n    }\n    error(message, data, options) {\n        this.log(LogLevel.error, message, data, options);\n    }\n    log(level, message, data, options) {\n        const transformedData = this.dataTransformer.getTransformedData(level, data);\n        if (!this.ignoreRemote(options)) {\n            this.getProxy().log({\n                level,\n                source: this.source,\n                loggerId: this.loggerId,\n                message,\n                data: transformedData,\n            });\n        }\n        if (this.applyDuplicateMessageToConsole(level, options)) {\n            logToConsole(level, message, transformedData);\n        }\n    }\n    getProvider() {\n        if (!this.provider) {\n            this.provider = this.providerFactory\n                ? this.providerFactory()\n                : getGlobalProvider();\n        }\n        return this.provider;\n    }\n    getProxy() {\n        if (!this._proxy) {\n            this._proxy = this.getProvider().getProxy();\n        }\n        return this._proxy;\n    }\n    applyDuplicateMessageToConsole(level, options) {\n        return ((options === null || options === void 0 ? void 0 : options.duplicateMessageToConsole) || this.getLogConsoleLevel() <= level);\n    }\n    getLogConsoleLevel() {\n        var _a, _b, _c, _d;\n        if (!this._logToConsoleLevel) {\n            this._logToConsoleLevel = ((_a = this.logOptions) === null || _a === void 0 ? void 0 : _a.minLogToConsoleLevelOverride)\n                ? this.logOptions.minLogToConsoleLevelOverride\n                : ((_d = (_c = (_b = this.getProvider().config) === null || _b === void 0 ? void 0 : _b.logging) === null || _c === void 0 ? void 0 : _c.minLogToConsoleLevel) !== null && _d !== void 0 ? _d : LogLevel.error);\n        }\n        return this._logToConsoleLevel;\n    }\n    ignoreRemote(options) {\n        var _a, _b, _c;\n        return (((_b = (_a = this.logOptions) === null || _a === void 0 ? void 0 : _a.remoteIgnore) !== null && _b !== void 0 ? _b : false) ||\n            ((_c = options === null || options === void 0 ? void 0 : options.remoteIgnore) !== null && _c !== void 0 ? _c : false));\n    }\n}\n//# sourceMappingURL=connect-logger.js.map","import { deepClone } from \"../utility/deep-clone\";\nexport function sanitizeData(data) {\n    if (!data)\n        return undefined;\n    try {\n        return deepClone(data);\n    }\n    catch (_a) {\n        return {\n            error: \"Data failed to sanitize. The original data is not available\",\n        };\n    }\n}\n//# sourceMappingURL=sanitize-data.js.map","import { sanitizeData } from \"./sanitize-data\";\nexport function createLogMessage({ level, source, message, loggerId, data }, context, messageOrigin) {\n    // Sanitize guards against a caller provided data object containing a\n    // non-cloneable object which will fail if sent through a message channel\n    const sanitizedData = sanitizeData(data);\n    return {\n        type: \"log\",\n        level,\n        time: new Date(),\n        source,\n        message,\n        loggerId,\n        data: sanitizedData,\n        context,\n        messageOrigin,\n    };\n}\n//# sourceMappingURL=log-message-factory.js.map","import { ConnectError } from \"../error\";\nimport { ConnectLogger } from \"../logging\";\nimport { generateUUID } from \"../utility\";\nimport { getGlobalProvider, setGlobalProvider } from \"./global-provider\";\nexport class AmazonConnectProviderBase {\n    constructor({ config, proxyFactory }) {\n        this._id = generateUUID();\n        if (!proxyFactory) {\n            throw new Error(\"Attempted to get Proxy before setting up factory\");\n        }\n        if (!config) {\n            throw new Error(\"Failed to include config\");\n        }\n        this.proxyFactory = proxyFactory;\n        this._config = config;\n    }\n    get id() {\n        return this._id;\n    }\n    getProxy() {\n        if (!this.proxy) {\n            this.proxy = this.proxyFactory(this);\n            this.proxy.init();\n        }\n        return this.proxy;\n    }\n    get config() {\n        return Object.assign({}, this._config);\n    }\n    onError(handler) {\n        this.getProxy().onError(handler);\n    }\n    offError(handler) {\n        this.getProxy().offError(handler);\n    }\n    static initializeProvider(provider) {\n        if (this.isInitialized) {\n            const msg = \"Attempted to initialize provider more than one time.\";\n            const details = {};\n            try {\n                // Attempts to get the existing provider for logging\n                const existingProvider = getGlobalProvider();\n                const logger = new ConnectLogger({\n                    source: \"core.amazonConnectProvider.init\",\n                    provider: existingProvider,\n                });\n                logger.error(msg);\n            }\n            catch (e) {\n                // In the event of a error when logging or attempting\n                // to get provider when logging, capture the message\n                // in the error being thrown\n                details.loggingError = e === null || e === void 0 ? void 0 : e.message;\n            }\n            throw new ConnectError({\n                errorKey: \"attemptInitializeMultipleProviders\",\n                reason: msg,\n                details,\n            });\n        }\n        setGlobalProvider(provider);\n        this.isInitialized = true;\n        // Getting the proxy sets up the connection with subject\n        provider.getProxy();\n        return provider;\n    }\n}\nAmazonConnectProviderBase.isInitialized = false;\n//# sourceMappingURL=provider-base.js.map","import { ConnectLogger } from \"../logging\";\nimport { ConnectMetricRecorder, } from \"../metric\";\nimport { createModuleProxy } from \"../proxy\";\nexport class ModuleContext {\n    constructor(engineContext, moduleNamespace) {\n        this.engineContext = engineContext;\n        this.moduleNamespace = moduleNamespace;\n    }\n    get proxy() {\n        if (!this.moduleProxy) {\n            const proxy = this.engineContext.getProvider().getProxy();\n            const moduleNamespace = this.moduleNamespace;\n            this.moduleProxy = createModuleProxy(proxy, moduleNamespace);\n        }\n        return this.moduleProxy;\n    }\n    getProvider() {\n        return this.engineContext.getProvider();\n    }\n    createLogger(params) {\n        if (typeof params === \"object\") {\n            return new ConnectLogger(Object.assign(Object.assign({}, params), { provider: () => this.engineContext.getProvider() }));\n        }\n        else {\n            return new ConnectLogger({\n                source: params,\n                provider: () => this.engineContext.getProvider(),\n            });\n        }\n    }\n    createMetricRecorder(params) {\n        if (typeof params === \"object\") {\n            return new ConnectMetricRecorder(Object.assign(Object.assign({}, params), { provider: () => this.engineContext.getProvider() }));\n        }\n        else {\n            return new ConnectMetricRecorder({\n                namespace: params,\n                provider: () => this.engineContext.getProvider(),\n            });\n        }\n    }\n}\n//# sourceMappingURL=module-context.js.map","import { getGlobalProvider } from \"../provider\";\nimport { ModuleContext } from \"./module-context\";\nexport class Context {\n    constructor(provider) {\n        this._provider = provider;\n    }\n    getProvider() {\n        if (this._provider)\n            return this._provider;\n        else\n            return getGlobalProvider();\n    }\n    getModuleContext(namespace) {\n        return new ModuleContext(this, namespace);\n    }\n}\n//# sourceMappingURL=context.js.map","// Do not edit this file manually\nexport const sdkVersion = \"1.0.9\";\n//# sourceMappingURL=sdk-version.js.map","import { Context } from \"@amazon-connect/core\";\nexport class AppContext extends Context {\n    constructor({ provider, instanceId, config, parameters, contactScope, scope, launchedBy, }) {\n        super(provider);\n        this.appInstanceId = instanceId;\n        this.instanceId = instanceId;\n        this.config = config;\n        this.appConfig = config;\n        this.contactScope = contactScope;\n        this.scope = scope;\n        this.parameters = parameters;\n        this.launchedBy =\n            launchedBy !== null && launchedBy !== void 0 ? launchedBy : {\n                // Not a valid type, but launchedBy will always been provided\n                // in practice for apps\n                type: \"unknown\",\n            };\n    }\n}\n//# sourceMappingURL=app-context.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { ConnectLogger } from \"@amazon-connect/core\";\nexport class LifecycleManager {\n    constructor(provider) {\n        this.provider = provider;\n        this.state = { isRunning: false };\n        this.isCreated = false;\n        this.isDestroyed = false;\n        this.logger = new ConnectLogger({\n            source: \"app.lifecycleManager\",\n            provider,\n            mixin: () => ({\n                state: this.state,\n                isCreated: this.isCreated,\n                isDestroyed: this.isDestroyed,\n            }),\n        });\n    }\n    get appState() {\n        return Object.assign({}, this.state);\n    }\n    handleCreate(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (this.isDestroyed) {\n                this.logger.error(\"An attempt was Create after a Destroy. No Action\", {\n                    instanceId: params.context.instanceId,\n                });\n                return;\n            }\n            if (this.isCreated) {\n                this.logger.error(\"An attempt was invoke Create after it was already invoked. No Action\", { instanceId: params.context.instanceId });\n                return;\n            }\n            this.logger.debug(\"Begin Lifecycle Create\", {\n                instanceId: params.context.instanceId,\n            });\n            if (!((_a = this.provider.config) === null || _a === void 0 ? void 0 : _a.onCreate)) {\n                const msg = \"App did not specify an onCreated handler. This is required. Closing app\";\n                const data = {\n                    appInstanceId: params.context.instanceId,\n                    instanceId: params.context.instanceId,\n                };\n                this.logger.error(msg, { instanceId: params.context.instanceId });\n                this.provider.sendFatalError(msg, data);\n                return;\n            }\n            const { success } = yield this.handleLifecycleChange(Object.assign(Object.assign({}, params), { stage: \"create\" }), \n            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-explicit-any\n            (e) => this.provider.config.onCreate(e), true);\n            if (success) {\n                this.isCreated = true;\n                this.sendLifecycleHandlerCompletedMessage(params.context.instanceId, \"create\");\n            }\n        });\n    }\n    handleLifecycleChange(evt, action, isFatal) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let success = false;\n            try {\n                yield action(evt);\n                success = true;\n            }\n            catch (error) {\n                const { instanceId: instanceId } = evt.context;\n                if (isFatal) {\n                    const msg = `An fatal error occurred when handling a ${evt.stage} lifecycle action. Closing app`;\n                    this.logger.error(msg, { instanceId, error });\n                    this.provider.sendFatalError(msg, error);\n                }\n                else {\n                    this.logger.error(`An error occurred when handling a ${evt.stage} lifecycle action.`, {\n                        instanceId,\n                        error,\n                    });\n                }\n            }\n            return { success };\n        });\n    }\n    sendLifecycleHandlerCompletedMessage(appInstanceId, stage) {\n        this.logger.debug(`Sending lifecycle ${stage} completed signal`);\n        const proxy = this.provider.getProxy();\n        proxy.sendLifecycleHandlerCompleted(appInstanceId, stage);\n    }\n}\n//# sourceMappingURL=lifecycle-manager.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { AppContext } from \"../app-context\";\nimport { LifecycleManager, } from \"./lifecycle-manager\";\nexport class AppLifecycleManager extends LifecycleManager {\n    constructor(provider) {\n        super(provider);\n        this.startHandlers = new Set();\n        this.stopHandlers = new Set();\n    }\n    handleLifecycleChangeMessage(msg) {\n        const context = new AppContext({\n            provider: this.provider,\n            instanceId: msg.instanceId,\n            config: msg.config,\n            parameters: msg.parameters,\n            contactScope: msg.contactScope,\n            scope: msg.scope,\n            launchedBy: msg.launchedBy,\n        });\n        this.state.instanceId = msg.instanceId;\n        this.state.appInstanceId = msg.instanceId;\n        this.state.config = msg.config;\n        this.state.appConfig = msg.config;\n        this.state.contactScope = msg.contactScope;\n        const params = { context };\n        switch (msg.stage) {\n            case \"create\":\n                return this.handleCreate(params);\n            case \"start\":\n                return this.handleStart(params);\n            case \"stop\":\n                return this.handleStop(params);\n            case \"destroy\":\n                return this.handleDestroy(params);\n        }\n    }\n    onStart(handler, options) {\n        this.startHandlers.add(handler);\n        // Allows subscribers to get start information even if they add their\n        // subscription after the start event fires while app is running\n        if (options === null || options === void 0 ? void 0 : options.invokeIfRunning) {\n            if (this.state.isRunning) {\n                this.handleLifecycleChange(Object.assign(Object.assign({}, this.getAppLifecycleChangeParams()), { stage: \"start\" }), (e) => handler(e), false);\n            }\n        }\n    }\n    onStop(handler) {\n        this.stopHandlers.add(handler);\n    }\n    offStart(handler) {\n        this.startHandlers.delete(handler);\n    }\n    offStop(handler) {\n        this.stopHandlers.delete(handler);\n    }\n    handleStart(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.isDestroyed) {\n                this.logger.error(\"An attempt was Start after a Destroy. No Action\", {\n                    appInstanceId: params.context.instanceId,\n                });\n                return;\n            }\n            if (!this.isCreated) {\n                this.logger.error(\"An attempt was invoke Start before Create. No Action\", { appInstanceId: params.context.instanceId });\n                return;\n            }\n            this.state.isRunning = true;\n            this.logger.info(\"Begin Lifecycle Start\");\n            const handlerRunResult = yield Promise.all([...this.startHandlers].map((h) => this.handleLifecycleChange(Object.assign(Object.assign({}, params), { stage: \"start\" }), (e) => h(e), false)));\n            this.logger.debug(\"Completed all start handlers\", {\n                count: this.startHandlers.size,\n                errorCount: handlerRunResult.filter(({ success }) => !success).length,\n            });\n        });\n    }\n    handleStop(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.isDestroyed) {\n                this.logger.error(\"An attempt was Stop after a Destroy. No Action\", {\n                    appInstanceId: params.context.instanceId,\n                });\n                return;\n            }\n            if (!this.isCreated) {\n                this.logger.error(\"An attempt was invoke Stop before Create. No Action\", {\n                    appInstanceId: params.context.instanceId,\n                });\n                return;\n            }\n            this.state.isRunning = false;\n            this.logger.info(\"Begin Lifecycle Stop\");\n            const handlerRunResult = yield Promise.all([...this.stopHandlers].map((h) => this.handleLifecycleChange(Object.assign(Object.assign({}, params), { stage: \"stop\" }), (e) => h(e), false)));\n            this.logger.debug(\"Completed all stop handlers\", {\n                count: this.stopHandlers.size,\n                errorCount: handlerRunResult.filter(({ success }) => !success).length,\n            });\n        });\n    }\n    handleDestroy(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.isDestroyed) {\n                this.logger.error(\"An attempt was invoke Destroy multiple times. No Action\", {\n                    appInstanceId: params.context.instanceId,\n                });\n                return;\n            }\n            if (!this.isCreated) {\n                this.logger.error(\"An attempt was invoke Destroy before Create. No Action\", {\n                    appInstanceId: params.context.instanceId,\n                });\n                return;\n            }\n            this.isDestroyed = true;\n            this.state.isRunning = false;\n            this.logger.info(\"Begin Lifecycle Destroy\");\n            const { config } = this.provider;\n            const { success } = yield this.handleLifecycleChange(Object.assign(Object.assign({}, params), { stage: \"destroy\" }), (e) => (config.onDestroy ? config.onDestroy(e) : Promise.resolve()), true);\n            if (success) {\n                this.sendLifecycleHandlerCompletedMessage(params.context.instanceId, \"destroy\");\n            }\n        });\n    }\n    getAppLifecycleChangeParams() {\n        return {\n            context: new AppContext({\n                provider: this.provider,\n                instanceId: this.state.instanceId,\n                config: this.state.config,\n                contactScope: this.state.contactScope,\n                scope: this.state.scope,\n                parameters: this.state.parameters,\n                launchedBy: this.state.launchedBy,\n            }),\n        };\n    }\n}\n//# sourceMappingURL=app-lifecycle-manager.js.map","export const defaultValue = 5 * 1000;\nexport const minValue = 1;\nexport const maxValue = 60 * 1000;\nexport function getConnectionTimeout(config) {\n    var _a, _b;\n    return Math.max(1, Math.min(60000, (_b = (_a = config.workspace) === null || _a === void 0 ? void 0 : _a.connectionTimeout) !== null && _b !== void 0 ? _b : 5000));\n}\n//# sourceMappingURL=connection-timeout.js.map","import { ConnectLogger, Proxy, sdkVersion, TimeoutTracker, } from \"@amazon-connect/core\";\nimport { getConnectionTimeout } from \"./connection-timeout\";\nexport class AppProxy extends Proxy {\n    constructor(provider, lifecycleManager) {\n        super(provider);\n        this.channel = new MessageChannel();\n        this.lifecycleManager = lifecycleManager;\n        this.appLogger = new ConnectLogger({\n            source: \"app.appProxy\",\n            provider: provider,\n        });\n    }\n    get proxyType() {\n        return \"AppProxy\";\n    }\n    sendLifecycleHandlerCompleted(appInstanceId, stage) {\n        const msg = {\n            type: \"appLifecycleHandlerCompleted\",\n            stage,\n            appInstanceId,\n        };\n        this.sendOrQueueMessageToSubject(msg);\n    }\n    tryCloseApp(message, isFatalError, data) {\n        const msg = {\n            type: \"closeApp\",\n            isFatalError: isFatalError !== null && isFatalError !== void 0 ? isFatalError : false,\n            message,\n            data,\n        };\n        this.sendOrQueueMessageToSubject(msg);\n    }\n    sendServiceError(message, data) {\n        const msg = {\n            type: \"serviceError\",\n            message,\n            data,\n        };\n        this.sendOrQueueMessageToSubject(msg);\n    }\n    publish(topic, data) {\n        const msg = {\n            type: \"appPublish\",\n            topic,\n            data,\n        };\n        this.sendOrQueueMessageToSubject(msg);\n    }\n    initProxy() {\n        const hostInitMessage = {\n            type: \"connect-app-host-init\",\n            sdkVersion,\n            providerId: this.provider.id,\n        };\n        this.status.update({ status: \"initializing\" });\n        this.channel.port1.onmessage = (evt) => this.consumerMessageHandler(evt);\n        this.connectionTimer = TimeoutTracker.start(this.connectionTimeout.bind(this), getConnectionTimeout(this.provider.config));\n        window.parent.postMessage(hostInitMessage, \"*\", [this.channel.port2]);\n        this.appLogger.debug(\"Send connect message to configure proxy\");\n    }\n    sendMessageToSubject(message) {\n        this.channel.port1.postMessage(message);\n    }\n    getUpstreamMessageOrigin() {\n        if (document === null || document === void 0 ? void 0 : document.location) {\n            const { origin, pathname: path } = document.location;\n            return {\n                _type: \"app\",\n                providerId: this.provider.id,\n                origin,\n                path,\n            };\n        }\n        else {\n            return {\n                _type: \"app\",\n                providerId: this.provider.id,\n                origin: \"unknown\",\n                path: \"unknown\",\n            };\n        }\n    }\n    handleConnectionAcknowledge(msg) {\n        // ConnectionTimer will always be defined here\n        if (!this.connectionTimer.complete()) {\n            this.appLogger.error(\"Workspace connection acknowledge received after timeout. App is not connected to workspace.\", {\n                timeout: this.connectionTimer.timeoutMs,\n            });\n            return;\n        }\n        super.handleConnectionAcknowledge(msg);\n    }\n    handleMessageFromSubject(msg) {\n        switch (msg.type) {\n            case \"appLifecycle\":\n                this.lifecycleManager\n                    .handleLifecycleChangeMessage(msg)\n                    .catch((error) => {\n                    this.appLogger.error(\"An error occurred when invoking handleLifecycleChangeMessage\", { error });\n                });\n                break;\n            default:\n                super.handleMessageFromSubject(msg);\n        }\n    }\n    connectionTimeout(evt) {\n        this.status.update({\n            status: \"error\",\n            reason: \"Workspace connection timeout\",\n            details: Object.assign({}, evt),\n        });\n        this.publishError({\n            message: \"App failed to connect to workspace in the allotted time\",\n            key: \"workspaceConnectTimeout\",\n            details: Object.assign({}, evt),\n            isFatal: true,\n            proxyStatus: { initialized: false },\n        });\n    }\n    addContextToLogger() {\n        const { isRunning: appIsRunning } = this.lifecycleManager.appState;\n        if (document === null || document === void 0 ? void 0 : document.location) {\n            const { origin, pathname: path } = document.location;\n            return { appIsRunning, app: { origin, path } };\n        }\n        else {\n            return {\n                appIsRunning,\n                app: { origin: \"unknown\", path: \"unknown\" },\n            };\n        }\n    }\n}\n//# sourceMappingURL=app-proxy.js.map","import { AmazonConnectProviderBase, ConnectLogger, deepClone, getGlobalProvider, } from \"@amazon-connect/core\";\nimport { AppLifecycleManager } from \"./lifecycle/app-lifecycle-manager\";\nimport { AppProxy } from \"./proxy\";\nexport class AmazonConnectApp extends AmazonConnectProviderBase {\n    constructor(config) {\n        super({ config, proxyFactory: () => this.createProxy() });\n        this.lifecycleManager = new AppLifecycleManager(this);\n        this.logger = new ConnectLogger({ provider: this, source: \"app.provider\" });\n    }\n    static init(config) {\n        const provider = new AmazonConnectApp(config);\n        AmazonConnectApp.initializeProvider(provider);\n        return { provider };\n    }\n    static get default() {\n        return getGlobalProvider(\"AmazonConnectApp has not been initialized\");\n    }\n    createProxy() {\n        return new AppProxy(this, this.lifecycleManager);\n    }\n    onStart(handler, options) {\n        this.lifecycleManager.onStart(handler, options);\n    }\n    onStop(handler) {\n        this.lifecycleManager.onStop(handler);\n    }\n    offStart(handler) {\n        this.lifecycleManager.offStart(handler);\n    }\n    offStop(handler) {\n        this.lifecycleManager.offStop(handler);\n    }\n    sendCloseAppRequest(message) {\n        this.getProxy().tryCloseApp(message, false);\n    }\n    sendError(message, data) {\n        this.logger.error(message, data);\n    }\n    sendFatalError(message, data) {\n        this.getProxy().tryCloseApp(message, true, data ? deepClone(data) : undefined);\n    }\n    subscribe(topic, handler) {\n        this.getProxy().subscribe(topic, handler);\n    }\n    unsubscribe(topic, handler) {\n        this.getProxy().unsubscribe(topic, handler);\n    }\n    publish(topic, data) {\n        this.getProxy().publish(topic, deepClone(data));\n    }\n}\n//# sourceMappingURL=amazon-connect-app.js.map","export var AppContactScope;\n(function (AppContactScope) {\n    AppContactScope[\"CurrentContactId\"] = \"CURRENT_CONTACT\";\n})(AppContactScope || (AppContactScope = {}));\n//# sourceMappingURL=contact-scope.js.map","import { ServiceContext } from \"../service\";\nimport { LifecycleManager } from \"./lifecycle-manager\";\nexport class ServiceLifecycleManager extends LifecycleManager {\n    constructor(provider) {\n        super(provider);\n    }\n    handleLifecycleChangeMessage(msg) {\n        const context = new ServiceContext({\n            provider: this.provider,\n            instanceId: msg.instanceId,\n            config: msg.config,\n        });\n        this.state.appInstanceId = msg.appInstanceId;\n        this.state.instanceId = msg.instanceId;\n        this.state.appConfig = msg.appConfig;\n        this.state.config = msg.config;\n        const params = { context };\n        switch (msg.stage) {\n            case \"create\":\n                return this.handleCreate(params);\n            default:\n                this.logger.error(\"Attempted to send invalid stage to service\", {\n                    stage: msg.stage,\n                });\n                return Promise.reject(new Error(\"Invalid stage sent to service. Are you using AmazonConnectService for a 3P app? Use AmazonConnectApp\"));\n        }\n    }\n}\n//# sourceMappingURL=service-lifecycle-manager.js.map","import { AmazonConnectProviderBase, ConnectLogger, deepClone, getGlobalProvider, } from \"@amazon-connect/core\";\nimport { ServiceLifecycleManager } from \"../lifecycle/service-lifecycle-manager\";\nimport { AppProxy } from \"../proxy\";\nexport class AmazonConnectService extends AmazonConnectProviderBase {\n    constructor(config) {\n        super({ config, proxyFactory: () => this.createProxy() });\n        this.lifecycleManager = new ServiceLifecycleManager(this);\n        this.logger = new ConnectLogger({ provider: this, source: \"app.provider\" });\n    }\n    static init(config) {\n        const provider = new AmazonConnectService(config);\n        AmazonConnectService.initializeProvider(provider);\n        return { provider };\n    }\n    static get default() {\n        return getGlobalProvider(\"AmazonConnectService has not been initialized\");\n    }\n    createProxy() {\n        return new AppProxy(this, this.lifecycleManager);\n    }\n    sendError(message, data) {\n        this.logger.error(message, data);\n    }\n    sendFatalError(message, data) {\n        this.getProxy().sendServiceError(message, data ? deepClone(data) : undefined);\n    }\n    subscribe(topic, handler) {\n        this.getProxy().subscribe(topic, handler);\n    }\n    unsubscribe(topic, handler) {\n        this.getProxy().unsubscribe(topic, handler);\n    }\n    publish(topic, data) {\n        this.getProxy().publish(topic, deepClone(data));\n    }\n}\n//# sourceMappingURL=amazon-connect-service.js.map","import { Context } from \"@amazon-connect/core\";\nexport class ServiceContext extends Context {\n    constructor({ provider, instanceId, config, }) {\n        super(provider);\n        this.instanceId = instanceId;\n        this.config = config;\n    }\n}\n//# sourceMappingURL=service-context.js.map"],"names":["_provider","setGlobalProvider","provider","getGlobalProvider","notSetMessage","ConnectError","reason","namespace","errorKey","details","deepClone","object","cloneError","EmitterBase","loggerKey","ConnectLogger","parameter","handler","set","_a","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","reject","fulfilled","step","e","rejected","result","AsyncEventEmitter","event","handlers","error","generateStringId","length","a","d","generateUUID","c","createModuleProxy","proxy","command","data","topic","h","SubscriptionHandlerIdMap","existingId","handlerId","id","SubscriptionMap","key","param","_b","_c","_d","_e","addFactory","updateAction","noParam","withParam","SubscriptionManager","acc","DurationMetricRecorder","sendMetric","metricName","metricOptions","durationResult","MAX_METRIC_DIMENSIONS","checkDimensionLength","dimensions","optionalDimensions","createMetricMessage","metricData","time","messageOrigin","ConnectMetricRecorder","params","processedDimensions","processedMetricOptions","count","unit","clientTimeoutResponseErrorKey","formatClientTimeoutError","request","timeoutMs","requestData","DEFAULT_TIMEOUT_MS","createRequestHandler","onStart","onTimeout","adjustedTimeoutMs","isTimedOut","timeout","msg","RequestManager","requestId","response","createRequestMessage","__rest","s","p","i","sanitizeDownstreamMessage","message","other","ChannelManager","relayChildUpstreamMessage","connectionId","existingChannel","originalChannel","setupParams","port","providerId","sendDownstreamMessage","setUpstreamMessageHandler","targetProviderId","channelData","ErrorService","isFatal","connectionStatus","handlerError","HealthCheckManager","sendHealthCheck","getUpstreamMessageOrigin","interval","previousStatus","status","ProxyConnectionStatusManager","evt","Proxy","origin","resp","logData","logMsg","createLogMessage","metricMessage","handlerIdMapping","_","fullError","subscriptionHandlerCount","subscriptionHandlerIds","TimeoutTracker","onCancelled","ms","LogLevel","logToConsole","level","LogDataTransformer","mixin","options","transformedData","sanitizeData","source","loggerId","context","sanitizedData","AmazonConnectProviderBase","config","proxyFactory","existingProvider","ModuleContext","engineContext","moduleNamespace","Context","sdkVersion","AppContext","instanceId","parameters","contactScope","scope","launchedBy","LifecycleManager","success","action","appInstanceId","stage","AppLifecycleManager","handlerRunResult","getConnectionTimeout","AppProxy","lifecycleManager","isFatalError","hostInitMessage","path","appIsRunning","AmazonConnectApp","AppContactScope","ServiceLifecycleManager","ServiceContext","AmazonConnectService"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43]}