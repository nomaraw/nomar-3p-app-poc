
<!DOCTYPE html>
<html>
  <body style="font-family: system-ui, sans-serif; padding: 20px;">
    <h2>Nomar 3P App – Heartbeat Test</h2>
    <div id="status">Loading…</div>

    <script type="module">
      const status = (msg) => { document.getElementById('status').textContent = msg; };

      // Must run inside Amazon Connect Agent Workspace iframe.
      // If opened directly (standalone browser tab), SDK init is expected to fail per AWS docs. [1](https://deepwiki.com/amazon-connect/amazon-connect-chat-ui-examples/4.1-interactive-messages)
      const isEmbeddedInWorkspace = window.top !== window;
      if (!isEmbeddedInWorkspace) {
        status('❌ Not running inside Agent Workspace. Open me from the Apps launcher.');
        console.warn('Open this page via the Agent Workspace Apps launcher (Third‑party app).');
      } else {
        try {
          // Import the SDK as an ES module directly (no build) using jsDelivr’s +esm transformer. [2](https://aws.amazon.com/connect/self-service/)
          const AmazonConnectApp = await import(
            'https://cdn.jsdelivr.net/npm/@amazon-connect/app/+esm'
          );

          const sdk = AmazonConnectApp?.AmazonConnectApp;
          if (!sdk || typeof sdk.init !== 'function') {
            status('❌ SDK failed to load (no init).');
            console.error('SDK import yielded:', AmazonConnectApp);
          } else {
            // Initialize the SDK per the Agent Workspace developer guide (lifecycle onCreate/onDestroy). [1](https://deepwiki.com/amazon-connect/amazon-connect-chat-ui-examples/4.1-interactive-messages)
            const { provider } = sdk.init({
